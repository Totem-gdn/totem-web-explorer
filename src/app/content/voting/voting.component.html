<div class="w-full max-w-[1012px] flex flex-row items-start pb-12 px-10 pt-10 gap-8">
  <div class="w-full min-w-[276px] max-w-[300px] h-max">
    <ng-container *ngIf="(space$ | async) as space; else spaceLoader">
      <p class="text-[20px] font-[700]">Space</p>
      <div class="w-full flex flex-col p-5 rounded-[18px] space-card mt-4">
        <p class="text-[16px] font-[700] col-grey">ID: <span class="space-id">{{space.id}}</span></p>
        <p class="mt-2 text-[20px] font-[700]">{{space.name}}</p>
        <p class="text-[16px] font-[500] col-grey">{{space.about}}</p>
        <a class="link-to-snapshot text-[14px] font-[400] mt-3 flex items-center gap-2" href="https://demo.snapshot.org/#/totemgdn.eth" target="_blank">View on snapshot.org <mat-icon class="!w-5 !h-5" [svgIcon]="'mat_outline:open_in_new'"></mat-icon></a>
      </div>
      <p class="text-[20px] font-[700] mt-6">Strategie(s)</p>
      <div *ngFor="let strategie of space.strategies; index as i" class="w-full flex flex-col pt-5 rounded-[18px] space-card mt-4 overflow-hidden">
        <p class="text-[16px] font-[700] px-5">{{strategie.name}}</p>
        <div class="grid grid-cols-2 mt-1 px-5 pb-5">
          <p class="text-[14px] font-[500] col-grey">symbol</p>
          <p class="text-[14px] font-[500]">{{strategie.params.symbol}}</p>
          <p class="text-[14px] font-[500] col-grey">network</p>
          <p class="text-[14px] font-[500]">{{strategie.network}}</p>
          <p class="text-[14px] font-[500] col-grey">address</p>
          <p class="text-[14px] font-[500] cursor-pointer flex items-center"
          [cdkCopyToClipboard]="strategie.params.address || ''"
          [cdkCopyToClipboardAttempts]="2"
          (cdkCopyToClipboardCopied)="copied()">{{slice(strategie.params.address)}} <mat-icon class="!h-[16px] !w-[16px] ml-1" [svgIcon]="'mat_outline:content_copy'"></mat-icon></p>
          <p class="text-[14px] font-[500] col-grey">decimals</p>
          <p class="text-[14px] font-[500]">{{strategie.params.decimals}}</p>
        </div>
        <div class="w-full h-12 vp-by-strategie flex items-center px-5">
          <p class="text-[14px] font-[500]">VP by Strategy (my): <span class="text-[16px] font-[500]">{{myVotingPower.vp_by_strategy[i]}} {{strategie.params.symbol}}</span></p>
        </div>
      </div>
    </ng-container>
  </div>
  <div class="w-full min-w-[300px] max-w-[600px] flex flex-col">
    <ng-container *ngIf="(proposal$ | async) as proposal; else proposalLoader">
      <div class="w-full flex flex-row flex-wrap gap-4 items-start justify-between">
        <p class="text-[20px] font-[700]">Latest Proposal</p>
        <div class="w-max h-[30px] vp-by-strategie flex items-center px-5 rounded-[18px]">
          <p class="text-[14px] font-[500]">Your Voting Power: <span class="text-[16px] font-[500]">{{myVotingPower.vp}}</span></p>
        </div>
      </div>

      <div class="w-full h-max flex flex-col space-card p-5 rounded-[18px] mt-4">
        <p class="text-[16px] font-[700]">{{proposal.title}}&nbsp;&nbsp;<span class="proposal-state capitalize text-[16px] font-[500]">{{proposal.state}}</span></p>
        <p *ngIf="proposal.body" class="text-[14px] font-[500] mt-2 col-grey">{{proposal.body}}</p>
        <div class="divider mt-3"></div>
        <p class="text-[20px] font-[700] mt-4">{{lastProposalVotingState.voted ? 'Votes' : 'Cast your Vote'}}</p>
        <div class="flex flex-col gap-3 w-full mt-4 items-center">

          <div
          class="w-full h-[40px] option-item flex items-center justify-center rounded-[18px] cursor-pointer"
          *ngFor="let option of proposal.options"
          [ngClass]="{'selected': option.selected || lastProposalVotingState.choice === option.id}"
          [ngStyle]="{'pointer-events': lastProposalVotingState.voted ? 'none' : 'all'}"
          (click)="selectOption(option, proposal.options)">
            <p class="text-[16px] font-[500]">{{lastProposalVotingState.choice === option.id ? 'Your Vote: ' : ''}}{{option.value}}</p>
          </div>

          <button *ngIf="!(loading$ | async)" [disabled]="lastProposalVotingState.voted" matRipple class="totem-primary-button w-full h-12 text-[20px] font-semibold leading-[22px] !mt-2" (click)="castVote(proposal)">{{ lastProposalVotingState.voted ? 'Successfully voted' : 'Vote'}}</button>
          <div *ngIf="(loading$ | async)" class="w-full h-12 shrink-0 flex items-center justify-center mt-2">
            <totem-spinner></totem-spinner>
          </div>

        </div>

      </div>

      <p class="text-[20px] font-[700] mt-4">Information</p>

      <div class="w-full flex flex-col p-5 rounded-[18px] space-card mt-4">
        <div class="grid grid-cols-2 gap-2">
        <p class="text-[14px] font-[500] col-grey">Voting system</p>
        <p class="text-[14px] font-[500] capitalize">{{proposal.type}}</p>
        <p class="text-[14px] font-[500] col-grey">Start date</p>
        <p class="text-[14px] font-[500]">{{proposal.start * 1000 | date:'dd/MM/yyyy h:mm a'}}</p>
        <p class="text-[14px] font-[500] col-grey">End date</p>
        <p class="text-[14px] font-[500]">{{proposal.end * 1000 | date:'dd/MM/yyyy h:mm a'}}</p>
        <p class="text-[14px] font-[500] col-grey">Snapshot</p>
        <a class="text-[14px] font-[500] flex items-center gap-1" [href]="'https://mumbai.polygonscan.com/block/'+proposal.snapshot" target="_blank">{{proposal.snapshot | number:'1.0':'en-US'}} <mat-icon class="!w-4 !h-4" [svgIcon]="'mat_outline:open_in_new'"></mat-icon></a>
        </div>
      </div>

    </ng-container>
  </div>
  <!-- <div class="w-full min-w-[226px] max-w-[300px] h-max">
    <ng-container *ngIf="(proposal$ | async) as proposal; else infoLoader">
      <p class="text-[20px] font-[700]">Information</p>
      <div class="w-full flex flex-col p-5 rounded-[18px] space-card mt-4">
        <div class="grid grid-cols-3 gap-2">
        <p class="text-[14px] font-[500] col-grey">V. system</p>
        <p class="text-[14px] font-[500] col-span-2 capitalize">{{proposal.type}}</p>
        <p class="text-[14px] font-[500] col-grey">Start date</p>
        <p class="text-[14px] font-[500] col-span-2">{{proposal.start * 1000 | date:'dd/MM/yyyy h:mm a'}}</p>
        <p class="text-[14px] font-[500] col-grey">End date</p>
        <p class="text-[14px] font-[500] col-span-2">{{proposal.end * 1000 | date:'dd/MM/yyyy h:mm a'}}</p>
        </div>
      </div>
    </ng-container>
  </div> -->

</div>
<ng-template #spaceLoader>
  <div class="w-full flex flex-col">
    <span class="w-[80px] h-[30px] totem-skeleton"></span>
    <div class="flex flex-wrap w-full items-start justify-start h-[155px] gap-4 mt-4">
      <span class="w-full h-full totem-skeleton"></span>
    </div>
  </div>
</ng-template>
<ng-template #proposalLoader>
  <div class="w-full flex flex-col">
    <span class="w-[36%] h-[30px] totem-skeleton"></span>
    <div class="flex flex-wrap w-full items-start justify-start h-[200px] gap-4 mt-4">
      <span class="w-full h-full totem-skeleton"></span>
    </div>
  </div>
</ng-template>
<ng-template #infoLoader>
  <div class="w-full flex flex-col">
    <span class="w-[46%] h-[30px] totem-skeleton"></span>
    <div class="flex flex-wrap w-full items-start justify-start h-[178px] gap-4 mt-4">
      <span class="w-full h-full totem-skeleton"></span>
    </div>
  </div>
</ng-template>
